y = paste("Count of",names(titanic_clean)[i]),
title = paste("survived vs.", names(titanic_clean)[i]))
print(a)
}
}
for(i in 1:length(names(titanic_clean))){
if(is.numeric(titanic_clean[[i]])){
a <- titanic_clean %>%
ggplot(aes(x = survived_flag,
y = .[[i]])) +
geom_boxplot()+
labs(x = "survived",
y = names(titanic_clean)[i],
title = paste("survived vs.", names(titanic_clean)[i]))
print(a)
}else{
a <- titanic_clean %>%
ggplot(aes(x = survived_flag,
fill = .[[i]])) +
geom_bar()+
labs(x = "survived",
y = paste("Count of",names(titanic_clean)[i]),
title = paste("survived vs.", names(titanic_clean)[i]))
print(a)
}
}
for(i in 1:length(names(titanic_clean))){
if(is.numeric(titanic_clean[[i]])){
a <- titanic_clean %>%
ggplot(aes(x = survived_flag,
y = .[[i]])) +
geom_boxplot()+
labs(x = "survived",
y = names(titanic_clean)[i],
title = paste("survived vs.", names(titanic_clean)[i]))
print(a)
}else{
a <- titanic_clean %>%
ggplot(aes(x = survived_flag,
fill = .data[[i]])) +
geom_bar()+
labs(x = "survived",
y = paste("Count of",names(titanic_clean)[i]),
title = paste("survived vs.", names(titanic_clean)[i]))
print(a)
}
}
for(i in 1:length(names(titanic_clean))){
if(is.numeric(titanic_clean[[i]])){
a <- titanic_clean %>%
ggplot(aes(x = survived_flag,
y = .[[i]])) +
geom_boxplot()+
labs(x = "survived",
y = names(titanic_clean)[i],
title = paste("survived vs.", names(titanic_clean)[i]))
print(a)
}else{
a <- titanic_clean %>%
ggplot(aes(x = survived_flag,
fill = .[[i]])) +
geom_bar()+
labs(x = "survived",
y = paste("Count of",names(titanic_clean)[i]),
title = paste("survived vs.", names(titanic_clean)[i]))
print(a)
}
}
for(i in 1:length(names(titanic_clean))){
if(is.numeric(titanic_clean[[i]])){
a <- titanic_clean %>%
ggplot(aes(x = survived_flag,
y = .[[i]])) +
geom_boxplot()+
labs(x = "survived",
y = names(titanic_clean)[i],
title = paste("survived vs.", names(titanic_clean)[i]))
print(a)
}else{
a <- titanic_clean %>%
ggplot(aes(x = survived_flag,
fill = .[[i]])) +
geom_bar()+
labs(x = "survived",
y = paste("Count of",names(titanic_clean)[i]),
title = paste("survived vs.", names(titanic_clean)[i])) +
facet_wrap(~ .[[i]])
print(a)
}
}
for(i in 1:length(names(titanic_clean))){
if(is.numeric(titanic_clean[[i]])){
a <- titanic_clean %>%
ggplot(aes(x = survived_flag,
y = !!names(.)[[i]])) +
geom_boxplot()+
labs(x = "survived",
y = names(titanic_clean)[i],
title = paste("survived vs.", names(titanic_clean)[i]))
print(a)
}else{
a <- titanic_clean %>%
ggplot(aes(x = survived_flag,
fill = .[[i]])) +
geom_bar()+
labs(x = "survived",
y = paste("Count of",names(titanic_clean)[i]),
title = paste("survived vs.", names(titanic_clean)[i])) +
facet_wrap(~ .[[i]])
print(a)
}
}
for(i in 1:length(names(titanic_clean))){
if(is.numeric(titanic_clean[[i]])){
a <- titanic_clean %>%
ggplot(aes(x = survived_flag,
y = !!names(.)[[i]])) +
geom_boxplot()+
labs(x = "survived",
y = names(titanic_clean)[i],
title = paste("survived vs.", names(titanic_clean)[i]))
print(a)
}else{
a <- titanic_clean %>%
ggplot(aes(x = survived_flag,
fill = .[[i]])) +
geom_bar()+
labs(x = "survived",
y = paste("Count of",names(titanic_clean)[i]),
title = paste("survived vs.", names(titanic_clean)[i]))
print(a)
}
}
for(i in 1:length(names(titanic_clean))){
if(is.numeric(titanic_clean[[i]])){
a <- titanic_clean %>%
ggplot(aes(x = survived_flag,
y = !!names(.)[[i]])) +
geom_boxplot()+
labs(x = "survived",
y = names(titanic_clean)[i],
title = paste("survived vs.", names(titanic_clean)[i]))
print(a)
}else{
a <- titanic_clean %>%
ggplot(aes(x = survived_flag,
fill = !!names(.)[[i]])) +
geom_bar()+
labs(x = "survived",
y = paste("Count of",names(titanic_clean)[i]),
title = paste("survived vs.", names(titanic_clean)[i]))
print(a)
}
}
for(i in 1:length(names(titanic_clean))){
if(is.numeric(titanic_clean[[i]])){
a <- titanic_clean %>%
ggplot(aes(x = survived_flag,
y = !!names(.)[[i]])) +
geom_boxplot()+
labs(x = "survived",
y = names(titanic_clean)[i],
title = paste("survived vs.", names(titanic_clean)[i]))
print(a)
}else{
a <- titanic_clean %>%
ggplot(aes(x = survived_flag,
fill = .[[i]])) +
geom_bar()+
labs(x = "survived",
y = paste("Count of",names(titanic_clean)[i]),
title = paste("survived vs.", names(titanic_clean)[i])) +
facet_wrap(~ .[[i]])
print(a)
}
}
for(i in 1:length(names(titanic_clean))){
if(is.numeric(titanic_clean[[i]])){
a <- titanic_clean %>%
ggplot(aes(x = survived_flag,
y = !!names(.)[[i]])) +
geom_boxplot()+
labs(x = "survived",
y = names(titanic_clean)[i],
title = paste("survived vs.", names(titanic_clean)[i]))
print(a)
}else{
a <- titanic_clean %>%
ggplot(aes(x = survived_flag,
fill = .[[i]])) +
geom_bar()+
labs(x = "survived",
y = paste("Count of",names(titanic_clean)[i]),
title = paste("survived vs.", names(titanic_clean)[i]))
print(a)
}
}
a <- titanic_clean %>%
ggplot(aes(x = survived_flag,
y = get(!!names(.)[[i]]))) +
geom_boxplot()+
labs(x = "survived",
y = names(titanic_clean)[i],
title = paste("survived vs.", names(titanic_clean)[i]))
for(i in 1:length(names(titanic_clean))){
if(is.numeric(titanic_clean[[i]])){
a <- titanic_clean %>%
ggplot(aes(x = survived_flag,
y = get(!!names(.)[[i]]))) +
geom_boxplot()+
labs(x = "survived",
y = names(titanic_clean)[i],
title = paste("survived vs.", names(titanic_clean)[i]))
print(a)
}else{
a <- titanic_clean %>%
ggplot(aes(x = survived_flag,
fill = .[[i]])) +
geom_bar()+
labs(x = "survived",
y = paste("Count of",names(titanic_clean)[i]),
title = paste("survived vs.", names(titanic_clean)[i]))
print(a)
}
}
for(i in 1:length(names(titanic_clean))){
if(is.numeric(titanic_clean[[i]])){
a <- titanic_clean %>%
ggplot(aes(x = survived_flag,
y = get(!!names(.)[[i]]))) +
geom_boxplot()+
labs(x = "survived",
y = names(titanic_clean)[i],
title = paste("survived vs.", names(titanic_clean)[i]))
print(a)
}else{
a <- titanic_clean %>%
ggplot(aes(x = survived_flag,
fill = .[[i]])) +
geom_bar()+
labs(x = "survived",
y = paste("Count of",names(titanic_clean)[i]),
title = paste("survived vs.", names(titanic_clean)[i]))+
facet(~ get(!!names(.)))
print(a)
}
}
for(i in 1:length(names(titanic_clean))){
if(is.numeric(titanic_clean[[i]])){
a <- titanic_clean %>%
ggplot(aes(x = survived_flag,
y = get(!!names(.)[[i]]))) +
geom_boxplot()+
labs(x = "survived",
y = names(titanic_clean)[i],
title = paste("survived vs.", names(titanic_clean)[i]))
print(a)
}else{
a <- titanic_clean %>%
ggplot(aes(x = survived_flag,
fill = get(!!names(.)[[i]]))) +
geom_bar()+
labs(x = "survived",
y = paste("Count of",names(titanic_clean)[i]),
title = paste("survived vs.", names(titanic_clean)[i])) +
facet_wrap(as.function(paste("~", !!names(.)[[i]])))
print(a)
}
}
for(i in 1:length(names(titanic_clean))){
if(is.numeric(titanic_clean[[i]])){
a <- titanic_clean %>%
ggplot(aes(x = survived_flag,
y = get(!!names(.)[[i]]))) +
geom_boxplot()+
labs(x = "survived",
y = names(titanic_clean)[i],
title = paste("survived vs.", names(titanic_clean)[i]))
print(a)
}else{
a <- titanic_clean %>%
ggplot(aes(x = survived_flag,
fill = get(!!names(.)[[i]]))) +
geom_bar()+
labs(x = "survived",
y = paste("Count of",names(titanic_clean)[i]),
title = paste("survived vs.", names(titanic_clean)[i])) +
facet_wrap(as.formula(paste("~", !!names(.)[[i]])))
print(a)
}
}
a <- titanic_clean %>%
ggplot(aes(x = survived_flag,
fill = get(!!names(.)[[i]]))) +
geom_bar()+
labs(x = "survived",
y = paste("Count of",names(titanic_clean)[i]),
title = paste("survived vs.", names(titanic_clean)[i])) +
print(a)
for(i in 1:length(names(titanic_clean))){
if(is.numeric(titanic_clean[[i]])){
a <- titanic_clean %>%
ggplot(aes(x = survived_flag,
y = get(!!names(.)[[i]]))) +
geom_boxplot()+
labs(x = "survived",
y = names(titanic_clean)[i],
title = paste("survived vs.", names(titanic_clean)[i]))
print(a)
}else{
a <- titanic_clean %>%
ggplot(aes(x = survived_flag,
fill = get(!!names(.)[[i]]))) +
geom_bar()+
labs(x = "survived",
y = paste("Count of",names(titanic_clean)[i]),
title = paste("survived vs.", names(titanic_clean)[i])) +
print(a)
}
}
for(i in 1:length(names(titanic_clean))){
if(is.numeric(titanic_clean[[i]])){
a <- titanic_clean %>%
ggplot(aes(x = survived_flag,
y = get(!!names(.)[[i]]))) +
geom_boxplot()+
labs(x = "survived",
y = names(titanic_clean)[i],
title = paste("survived vs.", names(titanic_clean)[i]))
print(a)
}else{
a <- titanic_clean %>%
ggplot(aes(x = survived_flag,
fill = get(!!names(.)[[i]]))) +
geom_bar()+
labs(x = "survived",
y = paste("Count of",names(titanic_clean)[i]),
title = paste("survived vs.", names(titanic_clean)[i]))
print(a)
}
}
sample_frac(titanic_clean, 0.7)
0.7*712
titanic_train <- sample_frac(titanic_clean, 0.7)
anti_join(titanic_clean, titanic_train, by = "id")
anti_join(titanic_clean, titanic_train)
37+498
test_selection <- sample(1:nrow(titanic_clean), size = nrow(titanic_clean *0.2)
test_selection <- sample(1:nrow(titanic_clean), size = nrow(titanic_clean *0.2))
sample(1:nrow(titanic_clean), size = nrow(titanic_clean *0.2))
test_selection <- sample(1:nrow(titanic_clean), size = nrow(titanic_clean) * 0.2)
sample(1:nrow(titanic_clean), size = nrow(titanic_clean) * 0.2)
test_selection <- sample(1:nrow(titanic_clean), size = nrow(titanic_clean) * 0.2)
titanic_train <- titanic_clean[-test_selection]
test_selection <- sample(1:nrow(titanic_clean), size = nrow(titanic_clean) * 0.2)
titanic_train <- titanic_clean[!test_selection]
test_selection <- sample(1:nrow(titanic_clean), size = nrow(titanic_clean) * 0.2)
titanic_train <- titanic_clean[-test_selection,]
titanic_test <- titanic_clean[test_selection,]
142 + 570
titanic_test %>%
janitor::tabyl(survived)
titanic_train
titanic_test %>%
janitor::tabyl(survived_flag)
titanic_test %>%
janitor::tabyl(survived_flag)
titanic_train %>%
janitor::tabyl(survived_flag)
titanic_fit <- rpart(
formula = survived_flag ~ .,
data = titanic_train,
method = "class"
)
rpart.plot(
titanic_fit,
yesno = 2,
fallen.leaves = TRUE,
faclen = 6
digits = 4
titanic_fit <- rpart(
formula = survived_flag ~ .,
data = titanic_train,
method = "class"
)
rpart.plot(
titanic_fit,
yesno = 2,
fallen.leaves = TRUE,
faclen = 6,
digits = 4
)
rpart.plot(
titanic_fit,
yesno = 2,
fallen.leaves = TRUE,
faclen = 6,
digits = 4
)
titanic_clean$survived_flag %>% pull()
titanic_clean$survived_flag %>% unique()
rpart.plot(
titanic_fit,
yesno = 2,
fallen.leaves = TRUE,
faclen = 6,
type = 4,
digits = 4
)
rpart.plot(
titanic_fit,
yesno = 2,
fallen.leaves = TRUE,
faclen = 6,
extra = 101,
digits = 4
)
titanic_train %>%
mutate(pred = predictions(titanic_fit))
titanic_train %>%
summarise(survived_flag = n())
titanic_train %>%
group_by(survived_flag) %>%
summarise(survived_flag = n())
titanic_train %>%
group_by(survived_flag) %>%
summarise(n())
339/(231+339)
46/(156+46)
3
68 + 1
3.68+1.4+2.8
library(modelr)
titanic_test_pred <- titanic_test %>%
add_predictions(titanic_fit, type = "class")
titanic_test_pred
library(yardstick)
titanic_test_pred %>%
conf_mat(truth = survived_flag, estimate = pred)
bind_rows(accuracy(truth = dth_flag, estimate = pred),
sensitivity(truth = dth_flag, estimate = pred))
bind_rows(accuracy(truth = titanic_test_pred$survived_flag, estimate = titanic_test_pred$pred),
sensitivity(truth = titanic_test_pred$survived_flag, estimate = titanic_test_pred$pred)
)
rbind(accuracy(truth = titanic_test_pred$survived_flag, estimate = titanic_test_pred$pred),
sensitivity(truth = titanic_test_pred$survived_flag, estimate = titanic_test_pred$pred)
)
titanic_test_pred %>%
accuracy(truth = survied_flag, estimate = pred)
titanic_test_pred %>%
accuracy(truth = survived_flag, estimate = pred)
accuracy(truth = titanic_test_pred$survived_flag, estimate = titanic_test_pred$pred)
accuracy(truth = titanic_test_pred$survived_flag, estimate = titanic_test_pred$pred)
titanic_test_pred %>%
sensitivity(truth = survived_flag, estimate = pred)
titanic_test_pred %>%
specificity(truth = survived_flag, estimate = pred)
32/(25+32)
titanic_test_pred %>%
sensitivity(truth = survived_flag, estimate = pred)
79/85
titanic_test_pred %>%
sensitivity(truth = survived_flag, estimate = pred)
titanic_test_pred %>%
specificity(truth = survived_flag, estimate = pred)
titanic_test_pred %>%
accuracy(truth = survived_flag, estimate = pred)
titanic_test_pred %>%
sensitivity(truth = survived_flag, estimate = pred)
titanic_test_pred %>%
specificity(truth = survived_flag, estimate = pred)
summary(titanic_fit)
caret::confusionMatrix(truth = survived_flag, estimate = pred)
caret::confusionMatrix(titanic_test_pred$survived_flag, titanic_test_pred$pred)
tune_grid = expand.grid(
mtry = 1:6,
splitrule = c("gini", "extratrees"),
min.node.size = c(1, 3, 5)
)
library(ranger)
control <- trainControl(
method = "repeatedcv",
number = 5,
repeats = 10
)
library(ranger)
library(caret)
control <- trainControl(
method = "repeatedcv",
number = 5,
repeats = 10
)
tune_grid = expand.grid(
mtry = 1:6,
splitrule = c("gini", "extratrees"),
min.node.size = c(1, 3, 5)
)
rf_tune <- train(
survived_flag ~ .,
data = titanic_train,
method = "ranger",
metric = "Kappa",
num.trees = 1000,
importance = "impurity",
tuneGrid = tune_grid,
trControl = control
)
plot(rf_tune)
rf_tune
titanic_clean %>%
distinct(parch)
enframe(sort(importance(rf_tune)))
