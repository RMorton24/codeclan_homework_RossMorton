mall_scale %>%
summarise(across(.fns = sum(is.na(.x))))
mall_scale %>%
summarise(across(.fns = ~sum(is.na(.x))))
ggpairs(mall_scale, progress = FALSE)
mall_scale %>%
ggplot(aes(x = age, y = annual_income_k)) +
geom_point()
ggpairs(mall_scale)
mall_scale %>%
ggplot(aes(x = id, y = value)) +
geom_point() +
facet_wrap(.~variable)
mall_scale %>%
ggplot(aes(x = id, y = value)) +
geom_point() +
facet_wrap(.~.)
mall_scale %>%
ggplot(aes(x = id, y = value)) +
geom_point() +
facet_grid(.~variable)
ggpairs(mall_scale)
mall_scale %>%
ggpairs()
mall_scale %>%
ggpairs(columns = 2:4)
mall_scale %>%
ggcorr()
mall_scale %>%
ggcorr(label = TRUE)
mall_customer %>%
rename_with(.fn = ~str_replace(.,"\(*"))
mall_customer %>%
rename_with(.fn = ~str_replace(.,"\\(*"))
mall_customer %>%
rename_with(.fn = ~str_replace(.x,"\\(*"))
mall_customer %>%
rename_with(.fn = ~str_replace(.,"\\(*"))
mall_customer %>%
rename_with(.fn = ~str_replace(.,"a"))
mall_customer %>%
rename_with(.fn = ~str_replace(.,"a", ""))
mall_customer %>%
rename_with(.fn = ~str_replace(.,"\\(*", ""))
read_csv(here::here("data/mall_customers.csv")) %>%
rename_with(.fn = ~str_replace(.,"\\(*", ""))
read_csv(here::here("data/mall_customers.csv")) %>%
rename_with(.fn = ~str_replace(.,"\\(k*", ""))
read_csv(here::here("data/mall_customers.csv")) %>%
rename_with(.fn = ~str_replace(.,"\\(.*", ""))
mall_customer <- read_csv(here::here("data/mall_customers.csv")) %>%
rename_with(.fn = ~str_replace(.,"\\(.*", "")) %>%
janitor::clean_names()
skimr::skim(mall_customer)
mall_scale <- mall_customer %>%
select(-customer_id) %>%
mutate(across(where(is.numeric), .fns = scale))
# Quick check for standardisation
mall_scale %>%
select(where(is.numeric)) %>%
summarise(across(.fns = list(mean = colMeans,
sd = sd)))
mall_scale %>%
summarise(across(.fns = ~sum(is.na(.x))))
mall_scale %>%
ggpairs(columns = 2:4)
mall_scale
mall_scale %>%
ggpairs(columns = 2:4)
k_clusters <- tibble(k = 1:max_k) %>%
mutate(kclust = map(k, ~kmeans(mall_scale, .x, nstart = 25)),
tidied = map(kclust, tidy),
glanced = map(kclust, glance),
augmented = map(kclust, augment, mall_scale)
)
k_max <- 20
k_clusters <- tibble(k = 1:max_k) %>%
mutate(kclust = map(k, ~kmeans(mall_scale, .x, nstart = 25)),
tidied = map(kclust, tidy),
glanced = map(kclust, glance),
augmented = map(kclust, augment, mall_scale)
)
max_k <- 20
k_clusters <- tibble(k = 1:max_k) %>%
mutate(kclust = map(k, ~kmeans(mall_scale, .x, nstart = 25)),
tidied = map(kclust, tidy),
glanced = map(kclust, glance),
augmented = map(kclust, augment, mall_scale)
)
mall_scale
max_k <- 20
k_clusters <- tibble(k = 1:max_k) %>%
mutate(kclust = map(k, ~ kmeans(mall_scale, .x, nstart = 25)),
tidied = map(kclust, tidy),
glanced = map(kclust, glance),
augmented = map(kclust, augment, mall_scale)
)
k_clusters <- tibble(k = 1:max_k) %>%
mutate(kclust = map(k, ~ kmeans(mall_scale, .x, nstart = 25))),
tibble(k = 1:max_k) %>%
mutate(kclust = map(k, ~ kmeans(mall_scale, .x, nstart = 25)))
k_clusters <- tibble(k = 1:max_k) %>%
mutate(kclust = map(k, ~ kmeans(mall_scale, .x, nstart = 25)),
tidied = map(kclust, tidy),
glanced = map(kclust, glance),
augmented = map(kclust, augment, mall_scale)
)
max_k <- 20
k_clusters <- tibble(k = 1:max_k) %>%
mutate(kclust = purr::map(k, ~ kmeans(mall_scale, .x, nstart = 25)),
tidied = map(kclust, tidy),
glanced = map(kclust, glance),
augmented = map(kclust, augment, mall_scale)
)
max_k <- 20
k_clusters <- tibble(k = 1:max_k) %>%
mutate(kclust = map(k, ~ kmeans(mall_scale, .x, nstart = 25)),
tidied = map(kclust, tidy),
glanced = map(kclust, glance),
augmented = map(kclust, augment, mall_scale)
)
k_clusters <- tibble(k = 1:max_k) %>%
mutate(kclust = purrr::map(k, ~ kmeans(mall_scale, .x, nstart = 25)),
tidied = map(kclust, tidy),
glanced = map(kclust, glance),
augmented = map(kclust, augment, mall_scale)
)
tibble(k = 1:max_k
tibble(k = 1:max_k
max_k <- 20
k_clusters <- tibble(k = 1:max_k) %>%
mutate(
kclust = map(k, ~ kmeans(mall_scale, .x, nstart = 25)), # created k-cluster object in each row
tidied = map(kclust, tidy),
glanced = map(kclust, glance),
augmented = map(kclust, augment, mall_customer)
)
mall_scale
kmeans(mall_scale, centers = 6, nstart = 25)
mall_scale <- mall_customer %>%
column_to_rownames(customer_id) %>%
mutate(across(where(is.numeric), .fns = scale))
mall_customer
mall_customer
mall_scale <- mall_customer %>%
column_to_rownames(customer_id) %>%
mutate(across(where(is.numeric), .fns = scale))
mall_scale
mall_customer
mall_scale <- mall_customer %>%
column_to_rownames("customer_id") %>%
mutate(across(where(is.numeric), .fns = scale))
mall_scale
# Quick check for standardisation
mall_scale %>%
select(where(is.numeric)) %>%
summarise(across(.fns = list(mean = colMeans,
sd = sd)))
mall_scale %>%
summarise(across(.fns = ~sum(is.na(.x))))
mall_scale %>%
ggpairs(columns = 2:4)
max_k <- 20
k_clusters <- tibble(k = 1:max_k) %>%
mutate(
kclust = map(k, ~ kmeans(mall_scale, .x, nstart = 25)), # created k-cluster object in each row
tidied = map(kclust, tidy),
glanced = map(kclust, glance),
augmented = map(kclust, augment, mall_customer)
)
# Quick check for standardisation
mall_scale %>%
select(where(is.numeric)) %>%
summarise(across(.fns = list(mean = mean,
sd = sd)))
mall_scale
mall_scale <- mall_customer %>%
select(-c(gender, customer_id)) %>%
mutate(across(where(is.numeric), .fns = scale))
max_k <- 20
k_clusters <- tibble(k = 1:max_k) %>%
mutate(
kclust = map(k, ~ kmeans(mall_scale, .x, nstart = 25)), # created k-cluster object in each row
tidied = map(kclust, tidy),
glanced = map(kclust, glance),
augmented = map(kclust, augment, mall_customer)
)
k_clusters
mall_scale %>%
ggpairs()
mall_scale <- mall_customer %>%
select(-c(customer_id)) %>%
mutate(across(where(is.numeric), .fns = scale),
gender = as.factor(gender))
mall_scale
mall_scale %>%
ggpairs()
max_k <- 20
k_clusters <- tibble(k = 1:max_k) %>%
mutate(
kclust = map(k, ~ kmeans(mall_scale, .x, nstart = 25)), # created k-cluster object in each row
tidied = map(kclust, tidy),
glanced = map(kclust, glance),
augmented = map(kclust, augment, mall_customer)
)
mall_scale <- mall_customer %>%
select(-c(customer_id)) %>%
mutate(across(where(is.numeric), .fns = scale),
gender = as.logical(gender))
mall_scale
mall_customer
mall_scale <- mall_customer %>%
select(-c(customer_id)) %>%
mutate(across(where(is.numeric), .fns = scale),
gender = if_else("Male", 1, 0))
mall_scale <- mall_customer %>%
select(-c(customer_id)) %>%
mutate(across(where(is.numeric), .fns = scale),
gender = if_else(gender == "Male", 1, 0))
mall_scale
mall_scale %>%
ggpairs()
max_k <- 20
k_clusters <- tibble(k = 1:max_k) %>%
mutate(
kclust = map(k, ~ kmeans(mall_scale, .x, nstart = 25)), # created k-cluster object in each row
tidied = map(kclust, tidy),
glanced = map(kclust, glance),
augmented = map(kclust, augment, mall_customer)
)
kmeans(mall_scale, centers = 6, nstart = 25)
mall_scale_no_gender <- mall_customer %>%
select(-c(customer_id, gender)) %>%
mutate(across(where(is.numeric), .fns = scale))
clusterings %>%
ggplot(aes(k, tot.withinss)) +
geom_line() +
geom_point() +
scale_x_continuous(breaks = 1:max_k)
clusterings <- k_clusters %>%
unnest(glanced)
clusterings %>%
ggplot(aes(k, tot.withinss)) +
geom_line() +
geom_point() +
scale_x_continuous(breaks = 1:max_k)
# Elbow /slihouette of mall no gender
fviz_nbclust(mall_scale, kmeans, method = "wss", nstart = 25)
fviz_nbclust(mall_scale, kmeans, method = "silhouette", nstart = 25)
# Elbow/Silhouette of mall with gender
fviz_nbclust(mall_scale, kmeans, method = "wss", nstart = 25)
fviz_nbclust(mall_scale, kmeans, method = "silhouette", nstart = 25)
fviz_nbclust(mall_scale, kmeans, method = "start", nstart = 25)
fviz_nbclust(mall_scale, kmeans, method = "gap_start", nstart = 25)
# Elbow/Silhouette of mall with gender
fviz_nbclust(mall_scale, kmeans, method = "wss", nstart = 25)
fviz_nbclust(mall_scale, kmeans, method = "silhouette", nstart = 25)
fviz_nbclust(mall_scale, kmeans, method = "gap_stat", nstart = 25)
# Elbow /slihouette of mall no gender
fviz_nbclust(mall_scale, kmeans, method = "wss", nstart = 25)
fviz_nbclust(mall_scale, kmeans, method = "silhouette", nstart = 25)
fviz_nbclust(mall_scale, kmeans, method = "gap_stat", nstart = 25)
# Elbow /slihouette of mall no gender
fviz_nbclust(mall_scale_no_gender, kmeans, method = "wss", nstart = 25)
fviz_nbclust(mall_scale_no_gender, kmeans, method = "silhouette", nstart = 25)
fviz_nbclust(mall_scale_no_gender, kmeans, method = "gap_stat", nstart = 25)
cluster_with_gender <- mall_scale %>%
kmeans(centers = 6, nstart = 25)
cluster_with_gender <- mall_scale %>%
kmeans(centers = 6, nstart = 25)
cluster_with_no_gender <- mall_scale_no_gender %>%
kmeans(centers = 6, nstart = 25)
mall_gender <- augment(cluster_with_gender, mall_customer)
mall_gender <- augment(cluster_with_gender, mall_customer)
mall_no_gender <- augment(cluster_with_no_gender, mall_customer)
mall_gender
mall_gender %>%
ggpairs(progress = FALSE)
mall_gender %>%
ggpairs(columns = 2:4, progress = FALSE,
aes(colour = .cluster))
mall_gender %>%
ggpairs(columns = 3:5, progress = FALSE,
aes(colour = .cluster))
mall_gender %>%
ggpairs(column = 3:5, progress = FALSE,
aes(colour = .cluster))
mall_no_gender %>%
ggpairs(column = 3:5, progress = FALSE,
aes(colour = .cluster))
cluster_with_gender
mall_no_gender %>%
ggpairs(column = 3:5, progress = FALSE,
aes(colour = .cluster), legend = 1)
mall_gender %>%
ggpairs(column = 3:5, progress = FALSE,
aes(colour = .cluster), legend = 1,
upper = "blank", diag = "blank")
mall_gender %>%
ggpairs(column = 3:5, progress = FALSE,
aes(colour = .cluster), legend = 1,
upper = NULL, diag = NULL)
mall_gender %>%
ggpairs(column = 3:5, progress = FALSE,
mapping = aes(colour = .cluster), legend = 1,
upper = NULL, diag = NULL)
mall_gender %>%
ggpairs(column = 3:5, progress = FALSE,
diag = NULL,
mapping = aes(colour = .cluster), legend = 1)
mall_gender %>%
ggpairs(column = 3:5, progress = FALSE,
mapping = aes(colour = .cluster), legend = 1)
mall_gender %>%
ggpairs(column = 3:5, progress = FALSE, upper = "blank",
mapping = aes(colour = .cluster), legend = 1)
mall_gender %>%
ggpairs(column = 3:5, progress = FALSE, upper = "blank",
diag = "blank",
mapping = aes(colour = .cluster), legend = 1)
mall_gender %>%
ggpairs(column = 3:5, progress = FALSE, upper = "blank",
lower = list(continous = "points"), diag = "blank",
mapping = aes(colour = .cluster), legend = 1)
mall_gender %>%
ggpairs(column = 3:5, progress = FALSE, upper = "blank",
lower = list(continuous = "points"), diag = "blank",
mapping = aes(colour = .cluster), legend = 1)
mall_gender %>%
ggpairs(column = 3:5, progress = FALSE, upper = "blank",
mapping = aes(colour = .cluster), legend = 1)
mall_gender %>%
ggpairs(column = 3:5, progress = FALSE, upper = "blank",diag = "blank",
mapping = aes(colour = .cluster), legend = 1)
mall_gender %>%
ggpairs(column = 3:5, progress = FALSE,
lower = list(continuous = "smooth"),
diag = list(continuous = "blank"),
upper = list(continuous = "blank")
mapping = aes(colour = .cluster), legend = 1)
mall_gender %>%
ggpairs(column = 3:5, progress = FALSE,
lower = list(continuous = "smooth"),
diag = list(continuous = "blank"),
upper = list(continuous = "blank"),
mapping = aes(colour = .cluster), legend = 1)
mall_gender %>%
ggpairs(column = 3:5, progress = FALSE,
lower = list(continuous = "points"),
diag = list(continuous = "blank"),
upper = list(continuous = "blank"),
mapping = aes(colour = .cluster), legend = 1)
mall_gender %>%
ggpairs(column = 3:5, progress = FALSE,
lower = list(continuous = "points"),
diag = list(continuous = "blank"),
upper = list(continuous = "blank"), legend = 1)
mall_gender %>%
ggpairs(column = 3:5, progress = FALSE,
lower = list(continuous = "points"),
#diag = list(continuous = "blank"),
upper = list(continuous = "blank"), legend = 1)
mall_gender %>%
ggpairs(column = 3:5, progress = FALSE,
mapping = aes(colour = .cluster), legend = 1)
mall_no_gender
mall_no_gender %>%
group_by(.cluster) %>%
summarise(across(where(isnumeric), .fns = mean))
mall_no_gender %>%
group_by(.cluster) %>%
summarise(across(where(is.numeric), .fns = mean))
mall_no_gender %>%
group_by(.cluster) %>%
summarise(across(where(is.numeric), .fns = mean)) %>%
select(-customer_id)
mall_no_gender %>%
group_by(.cluster) %>%
summarise(across(where(is.numeric), .fns = mean)) %>%
select(-customer_id)
mall_gender %>%
group_by(.cluster) %>%
summarise(across(where(is.numeric), .fns = mean)) %>%
select(-customer_id)
mall_gender %>%
group_by(.cluster) %>%
summarise(across(where(is.numeric), .fns = mean)) %>%
select(-customer_id)
mall_gender %>%
group_by(.cluster) %>%
summarise(across(where(is.numeric), .fns = mean),
male = sum(gender == "Male")/nrow(.)) %>%
select(-customer_id)
mall_gender %>%
group_by(.cluster) %>%
summarise(across(where(is.numeric), .fns = mean),
male = 100*sum(gender == "Male")/nrow(.)) %>%
select(-customer_id)
mall_gender %>%
group_by(.cluster) %>%
summarise(across(where(is.numeric), .fns = mean),
male = 100*sum(gender != "Male")/nrow(.)) %>%
select(-customer_id)
mall_gender %>%
group_by(.cluster) %>%
summarise(across(where(is.numeric), .fns = mean),
male = nrow(.)) %>%
select(-customer_id)
mall_gender %>%
group_by(.cluster) %>%
summarise(n())
mall_gender %>%
group_by(.cluster) %>%
summarise(across(where(is.numeric), .fns = mean),
male = sum(gender == "Male")) %>%
select(-customer_id)
mall_gender %>%
group_by(.cluster) %>%
summarise(across(where(is.numeric), .fns = mean),
male = sum(gender == "Male"),
femal = sum(gender == "Female")) %>%
select(-customer_id)
mall_gender %>%
group_by(.cluster) %>%
summarise(across(where(is.numeric), .fns = mean),
no_male = sum(gender == "Male"),
no_female = sum(gender == "Female")) %>%
select(-customer_id)
mall_gender %>%
group_by(.cluster) %>%
summarise(across(where(is.numeric), .fns = mean),
num_male = sum(gender == "Male"),
num_female = sum(gender == "Female")) %>%
select(-customer_id)
mall_gender %>%
group_by(.cluster) %>%
summarise(across(where(is.numeric), .fns = mean),
num_male = sum(gender == "Male")/n(),
num_female = sum(gender == "Female"),) %>%
select(-customer_id)
10/23
mall_gender %>%
group_by(.cluster) %>%
summarise(across(where(is.numeric), .fns = mean),
perc_male = 100*sum(gender == "Male")/n(),
num_female = 100*sum(gender == "Female")/n(),) %>%
select(-customer_id)
mall_no_gender %>%
group_by(.cluster) %>%
summarise(across(where(is.numeric), .fns = mean),
perc_male = 100*sum(gender == "Male")/n(),
num_female = 100*sum(gender == "Female")/n(),) %>%
select(-customer_id)
mall_no_gender %>%
ggpairs(column = 2:5, progress = FALSE,
aes(colour = .cluster), legend = 1)
mall_no_gender %>%
ggpairs(column = 3:5, progress = FALSE,
aes(colour = .cluster), legend = 1)
mall_gender %>%
ggpairs(column = 2:5, progress = FALSE,
mapping = aes(colour = .cluster), legend = 1)
mall_gender %>%
group_by(.cluster) %>%
summarise(across(where(is.numeric), .fns = mean),
perc_male = 100*sum(gender == "Male")/n(),
num_female = 100*sum(gender == "Female")/n(),
perc_data = n()/nrow(.)) %>%
select(-customer_id)
mall_gender %>%
group_by(.cluster) %>%
summarise(across(where(is.numeric), .fns = mean),
perc_male = 100*sum(gender == "Male")/n(),
num_female = 100*sum(gender == "Female")/n(),
perc_data = 100*n()/nrow(.)) %>%
select(-customer_id)
mall_no_gender %>%
group_by(.cluster) %>%
summarise(across(where(is.numeric), .fns = mean),
perc_male = 100*sum(gender == "Male")/n(),
num_female = 100*sum(gender == "Female")/n(),
perc_data = 100*n()/nrow(.)) %>%
select(-customer_id)
Icluster_with_gender
cluster_with_gender
glance(cluster_with_gender)
bind_rows("has_gender" = glance(cluster_with_gender),
"no_gender" = glance(cluster_with_no_gender))
mall_gender %>%
group_by(.cluster) %>%
summarise(across(where(is.numeric), .fns = mean),
perc_male = 100*sum(gender == "Male")/n(),
perc_female = 100*sum(gender == "Female")/n(),
perc_data = 100*n()/nrow(.),
age_range = paset(min(age), "to", max(age))) %>%
select(-customer_id)
mall_gender %>%
group_by(.cluster) %>%
summarise(across(where(is.numeric), .fns = mean),
perc_male = 100*sum(gender == "Male")/n(),
perc_female = 100*sum(gender == "Female")/n(),
perc_data = 100*n()/nrow(.),
age_range = paste(min(age), "to", max(age))) %>%
select(-customer_id)
mall_gender %>%
group_by(.cluster) %>%
summarise(age_range = paste(min(age), "to", max(age)),
across(where(is.numeric), .fns = mean),
perc_male = 100*sum(gender == "Male")/n(),
perc_female = 100*sum(gender == "Female")/n(),
perc_data = 100*n()/nrow(.)) %>%
select(-customer_id)
