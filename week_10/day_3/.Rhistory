library(tidyverse)
library(modelr)
library(GGally)
library(ggfortify)
kc_hous <- read_csv(here::here("data/kc_house_data.csv"))
kc_house <- read_csv(here::here("data/kc_house_data.csv"))
kc_house <- read_csv(here::here("data/kc_house_data.csv"))
head(kc_house)
glimpse(kc_house)
skimr::skim(kc_house)
distinct(kc_house$zipcode)
unique(kc_house$zipcode)
head(kc_house)
glimpse(kc_house)
skimr::skim(kc_house)
kc_house %>%
ggplot(aes(x = sqft_living15, y = price)) +
geom_point()
kc_house %>%
ggplot(aes(x = sqft_living15, y = price)) +
geom_point()
kc_house %>%
ggplot(aes(x = sqft_living15, y = sqft_living)) +
geom_point()
kc_house %>%
ggplot(aes(x = sqft_living15, y = price)) +
geom_point()
kc_house %>%
ggplot(aes(x = sqft_living15, y = sqft_living)) +
geom_point()
kc_house %>%
ggplot(aes(x = sqft_lot15, y = price)) +
geom_point()
kc_house %>%
ggplot(aes(x = sqft_lot15, y = sqft_lot)) +
geom_point()
kc_modified %>%
select(-c(date, id, zipcode), -contains("15"))
kc_house %>%
select(-c(date, id, zipcode), -contains("15"))
kc_house %>%
select(-c(date, id, zipcode), -contains("15")) %>%
mutate(yr_renovated = if_else(yr_renovated != 0, 1, 0),
grade = factor(grade))
kc_house %>%
select(-c(date, id, zipcode), -contains("15")) %>%
mutate(yr_renovated = if_else(yr_renovated != 0, 1, 0),
grade = factor(grade),
condition = factor(condition),
view = factor(view))
kings_county_house <- kc_house %>%
select(-c(date, id, zipcode), -contains("15")) %>%
mutate(yr_renovated = if_else(yr_renovated != 0, 1, 0),
grade = factor(grade),
condition = factor(condition),
view = factor(view))
alias(lm(price ~., data = kings_county_house))
kings_county_house <- kc_house %>%
select(-c(date, id, zipcode, sqft_above), -contains("15")) %>%
mutate(yr_renovated = if_else(yr_renovated != 0, 1, 0),
grade = factor(grade),
condition = factor(condition),
view = factor(view))
alias(lm(price ~., data = kings_county_house))
kings_county_house %>%
select(where(is.numeric))
kings_county_house %>%
select(-where(is.numeric))
ggpairs_plots <- function(data){
data %>%
select(where(is.numeric)) %>%
ggpairs(progress = FALSE) %>%
print()
data %>%
select(-where(is.numeric)) %>%
ggpairs(progress = FALSE) %>%
print()
}
kings_county_house %>%
ggpairs_plots()
kc_house
kings_county_house <- kc_house %>%
select(-c(date, id, zipcode, sqft_above), -contains("15")) %>%
mutate(yr_renovated = if_else(yr_renovated != 0, TRUE, FALSE),
grade = factor(grade),
condition = factor(condition),
view = factor(view),
waterfront = as.logical(waterfront))
alias(lm(price ~., data = kings_county_house))
ggpairs_plots <- function(data){
data %>%
select(where(is.numeric)) %>%
ggpairs(progress = FALSE) %>%
print()
data %>%
select(price, -where(is.numeric)) %>%
ggpairs(progress = FALSE) %>%
print()
}
kings_county_house %>%
ggpairs_plots()
kings_county_house %>%
select(price, -where(is.numeric))
kings_county_house
kings_county_house %>%
select(price, -where(is.numeric))
kings_county_house %>%
select(-where(is.numeric))
kings_county_house %>%
select(-where(is.numeric), price)
kings_county_house
model_1_bed <- lm(price ~ sqft_living,
data = kings_county_house)
summary(model_1_bed)
autoplot(model_1_bed)
model_1_bed <- lm(price ~ sqft_living,
data = kings_county_house)
summary(model_1_bed)
autoplot(model_1_bed)
resid_model_1 <-  kings_county_house %>%
add_residuals()
resid_model_1 <-  kings_county_house %>%
add_residuals(model_1_bed)
model_1_sqftliv <- lm(price ~ sqft_living,
data = kings_county_house)
resid_model_1 <-  kings_county_house %>%
add_residuals(model_1_sqftliv)
redid_model_1
resid_model_1 <-  kings_county_house %>%
add_residuals(model_1_sqftliv)
resid_model_1
data %>%
select(where(is.numeric)) %>%
ggpairs(progress = FALSE) %>%
print()
ggpairs_plots <- function(data, main_columns){
data %>%
select(where(is.numeric)) %>%
ggpairs(progress = FALSE) %>%
print()
data %>%
select(-where(is.numeric), main_columns) %>%
ggpairs(progress = FALSE) %>%
print()
}
resid_model_1 %>%
ggpairs_plots(c("price", "resid"))
resid_model_1 <-  kings_county_house %>%
select(-sqft_living) %>%
add_residuals(model_1_sqftliv)
resid_model_1
resid_model_1 <-  kings_county_house %>%
select(-sqft_living) %>%
add_residuals(model_1_sqftliv)
kings_county_house
kings_county_house %>%
select(-sqft_living)
resid_model_1 <-  kings_county_house %>%
select(-sqft_living) %>%
add_residuals(model_1_sqftliv)
resid_model_1 <-  kings_county_house %>%
select(-sqft_living)
resid_model_1 <-  kings_county_house
resid_model_1 %>%
select(-sqft_living) %>%
ggpairs_plots(c("price", "resid"))
resid_model_1 %>%
select(-where(is.numeric), c("price", "resid"))
resid_model_1 %>%
select(-where(is.numeric), . %in% c("price", "resid"))
resid_model_1 %>%
select(-where(is.numeric), contains(c("price", "resid")))
resid_model_1 %>%
select(-where(is.numeric), contains(c("price|resid")))
resid_model_1 %>%
select(-where(is.numeric), contains(c("price", "resid")))
resid_model_1
add_residuals(model_1_sqftliv)
resid_model_1
resid_model_1 <-  kings_county_house %>%
add_residuals(model_1_sqftliv)
resid_model_1 %>%
select(-where(is.numeric), contains(c("price", "resid")))
kings_county_house <- kc_house %>%
select(-c(date, id, zipcode, sqft_above), -contains("15")) %>%
mutate(yr_renovated = if_else(yr_renovated != 0, TRUE, FALSE),
grade = factor(grade),
condition = factor(condition),
view = factor(view),
waterfront = as.logical(waterfront))
data %>%
select(-where(is.numeric), main_columns) %>%
ggpairs(progress = FALSE) %>%
print()
ggpairs_plots <- function(data, main_columns){
data %>%
select(where(is.numeric)) %>%
ggpairs(progress = FALSE) %>%
print()
data %>%
select(-where(is.numeric), main_columns) %>%
ggpairs(progress = FALSE) %>%
print()
}
kings_county_house %>%
ggpairs_plots(c("price"))
model_1_sqftliv <- lm(price ~ sqft_living,
data = kings_county_house)
summary(model_1_sqftliv)
autoplot(model_1_sqftliv)
kings_county_house %>%
ggcorr()
resid_model_1 <-  kings_county_house %>%
add_residuals(model_1_sqftliv)
resid_model_1 %>%
select(-sqft_living) %>%
ggpairs_plots(c("price", "resid"))
model_2_lat <- lm(price ~ sqft_living + lat,
data = kings_county_house)
summary(model_2_lat)
autoplot(model_2_lat)
kings_county_house %>%
ggplot(aes(x = sqft_living)) %>%
geom_histogram()
kings_county_house %>%
ggplot(aes(x = sqft_living)) +
geom_histogram()
kings_county_house %>%
ggplot(aes(x = log(sqft_living))) +
geom_histogram()
model_1_sqftliv <- lm(price ~ log(sqft_living),
data = kings_county_house)
summary(model_1_sqftliv)
autoplot(model_1_sqftliv)
model_2_lat <- lm(price ~ log(sqft_living) + lat,
data = kings_county_house)
summary(model_2_lat)
summary(model_2_lat)
autoplot(model_2_lat)
model_1_grade <- lm(price ~ grade, data = kings_county_house)
summary(model_1_grade)
model_2_grade <- lm(price ~ log(sqft_living) + grade,
data = kings_county_house)
summary(model_2_grade)
resid_2 <- kings_county_house %>%
add_residuals(model_2_grade)
resid_2 %>%
ggpairs_plots(c("resid"))
model_3_long_lat <- lm(price ~ sqft_living + grade + lat:long,
data = kings_county_house)
summary(model_3_long_lat)
model_3_long_lat <- lm(price ~ log(sqft_living) + grade + lat:long,
data = kings_county_house)
summary(model_3_long_lat)
model_3_long_lat <- lm(price ~ log(sqft_living) + grade + lat*long,
data = kings_county_house)
summary(model_3_long_lat)
model_3_long_lat <- lm(price ~ sqft_living + grade + lat*long,
data = kings_county_house)
summary(model_3_long_lat)
autoplo(model_3_long_lat)
model_3_long_lat <- lm(price ~ sqft_living + grade + lat*long,
data = kings_county_house)
summary(model_3_long_lat)
autoplot(model_3_long_lat)
model_3_long_lat <- lm(price ~ log(sqft_living) + grade + lat*long,
data = kings_county_house)
model_3_long_lat <- lm(price ~ log(sqft_living) + grade + lat*long,
data = kings_county_house)
summary(model_3_long_lat)
autoplot(model_3_long_lat)
model_3_long_lat <- lm(log(price) ~ log(sqft_living) + grade + lat*long,
data = kings_county_house)
summary(model_3_long_lat)
autoplot(model_3_long_lat)
model_3_long_lat <- lm(log(price) ~ sqft_living + grade + lat*long,
data = kings_county_house)
summary(model_3_long_lat)
autoplot(model_3_long_lat)
anova(model_1_sqftliv, model_2_grade)
anova(model_2_grade, model_3_long_lat)
model_2_grade <- lm(log(price) ~ log(sqft_living) + grade,
data = kings_county_house)
summary(model_2_grade)
anova(model_2_grade, model_3_long_lat)
kings_county_house <- kc_house %>%
select(-c(date, id, zipcode, sqft_above), -contains("15")) %>%
mutate(yr_renovated = if_else(yr_renovated != 0, TRUE, FALSE),
grade = case_when(
grade <= 3 ~ "low"
grade <= 10 ~ "medium",
kings_county_house <- kc_house %>%
select(-c(date, id, zipcode, sqft_above), -contains("15")) %>%
mutate(yr_renovated = if_else(yr_renovated != 0, TRUE, FALSE),
grade = case_when(
grade <= 3 ~ "low",
grade <= 10 ~ "medium",
TRUE ~ "high"
),
condition = factor(condition),
view = factor(view),
waterfront = as.logical(waterfront))
model_1_sqftliv <- lm(price ~ log(sqft_living),
data = kings_county_house)
summary(model_1_sqftliv)
autoplot(model_1_sqftliv)
model_1_grade <- lm(price ~ grade, data = kings_county_house)
summary(model_1_grade)
model_2_lat <- lm(price ~ log(sqft_living) + lat,
data = kings_county_house)
summary(model_2_lat)
autoplot(model_2_lat)
model_2_grade <- lm(log(price) ~ log(sqft_living) + grade,
data = kings_county_house)
summary(model_2_grade)
anova(model_1_sqftliv, model_2_grade)
model_1_grade <- lm(log(price) ~ grade, data = kings_county_house)
summary(model_1_grade)
anova(model_1_sqftliv, model_2_grade)
model_3_long_lat <- lm(log(price) ~ sqft_living + grade + lat*long,
data = kings_county_house)
summary(model_3_long_lat)
autoplot(model_3_long_lat)
resid_model_1 <-  kings_county_house %>%
add_residuals(model_1_sqftliv)
resid_model_1 %>%
select(-sqft_living) %>%
ggpairs_plots(c("price", "resid"))
model_2_lat <- lm(log(price) ~ log(sqft_living) + lat,
data = kings_county_house)
summary(model_2_lat)
anova(model_1_sqftliv, model_2_lat)
model_3_long_lat <- lm(log(price) ~ sqft_living + lat*long,
data = kings_county_house)
model_3_long_lat <- lm(log(price) ~ sqft_living + lat*long,
data = kings_county_house)
summary(model_3_long_lat)
autoplot(model_3_long_lat)
anova(model_2_lat, model_3_long_lat)
model_1_grade <- lm(log(price) ~ grade, data = kings_county_house)
summary(model_1_grade)
model_2_lat <- lm(price ~ log(sqft_living) + lat,
data = kings_county_house)
summary(model_2_lat)
autoplot(model_2_lat)
model_2_grade <- lm(log(price) ~ log(sqft_living) + grade,
data = kings_county_house)
summary(model_2_grade)
model_3_long_lat <- lm(log(price) ~ sqft_living + grade + lat*long,
data = kings_county_house)
summary(model_3_long_lat)
autoplot(model_3_long_lat)
anova(model_2_grade, model_3_long_lat)
model_2_grade <- lm(log(price) ~ log(sqft_living) + grade,
data = kings_county_house)
summary(model_2_grade)
kings_county_house
kings_county_house <- kc_house %>%
select(-c(date, id, zipcode, sqft_above), -contains("15")) %>%
mutate(yr_renovated = if_else(yr_renovated != 0, TRUE, FALSE),
grade = factor(grade),
condition = factor(condition),
view = factor(view),
waterfront = as.logical(waterfront))
model_1_grade <- lm(log(price) ~ grade, data = kings_county_house)
summary(model_1_grade)
model_2_lat <- lm(log(price) ~ sqft_living + lat,
data = kings_county_house)
model_2_lat <- lm(log(price) ~ sqft_living + lat,
data = kings_county_house)
summary(model_2_lat)
autoplot(model_2_lat)
model_2_grade <- lm(log(price) ~ sqft_living + grade,
data = kings_county_house)
summary(model_2_grade)
anova(model_1_sqftliv, model_2_grade)
model_1_sqftliv <- lm(log(price) ~ log(sqft_living),
data = kings_county_house)
summary(model_1_sqftliv)
autoplot(model_1_sqftliv)
